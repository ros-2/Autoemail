# Lochross Outreach Bot

Automated job scraping and contact form filling for Lochross automation consulting.

## What It Does

1. **Scrapes job boards** (Indeed UK, S1jobs) for admin/receptionist roles in Scotland
2. **Finds company websites** via Google search
3. **Locates contact forms** or email addresses
4. **Auto-fills contact forms** with personalized messages (generated by Claude)
5. **Logs everything** to Google Sheets
6. **Sends daily summary** email

## Setup

### 1. Install Dependencies

```bash
pip install -r requirements.txt
```

### 2. Configure Google Sheets

1. Create a Google Cloud project at https://console.cloud.google.com/
2. Enable the Google Sheets API
3. Create a service account and download the JSON credentials
4. Save as `credentials/google_sheets_service.json`
5. Share your Google Sheet with the service account email

### 3. Set Up Environment Variables

Create a `.env` file (copy from `.env.example`):

```bash
cp .env.example .env
```

Then edit with your actual credentials:

```
ANTHROPIC_API_KEY=your_api_key_here
GOOGLE_SHEETS_CREDENTIALS_PATH=credentials/google_sheets_service.json
EMAIL_APP_PASSWORD=your_zoho_app_password
```

### 4. Configure Settings

Create `config/config.yaml` (copy from `config/config.yaml.example`):

```bash
cp config/config.yaml.example config/config.yaml
```

Edit with your settings:
- Google Sheets spreadsheet ID
- Search terms and locations
- Email settings

## Usage

### Test Run (Dry Run)

```bash
python run_daily.py --dry-run
```

This runs the full pipeline without actually submitting forms or logging to sheets.

### Live Run

```bash
python run_daily.py
```

### Limit Jobs Processed

```bash
python run_daily.py --max-jobs 5
```

## Schedule Daily Run (Windows)

1. Open Task Scheduler
2. Create Basic Task
3. Set trigger: Daily at 6:00 AM
4. Set action: Start a program
   - Program: `python`
   - Arguments: `C:\path\to\run_daily.py`
   - Start in: `C:\path\to\Autoemail\`

## Project Structure

```
Autoemail/
├── run_daily.py              # Main entry point
├── config/
│   ├── config.yaml           # Your settings (gitignored)
│   └── config.yaml.example   # Template
├── credentials/              # Google Sheets credentials (gitignored)
├── output/                   # Log files (gitignored)
├── src/
│   └── outreach_bot/
│       ├── scraper.py        # Job board scraping
│       ├── website_finder.py # Company website lookup
│       ├── contact_finder.py # Contact form/email detection
│       ├── email_drafter.py  # Claude API message generation
│       ├── form_filler.py    # Selenium form auto-fill
│       ├── sheets_logger.py  # Google Sheets logging
│       └── utils/            # Logging, validation, email
├── .env                      # API keys (gitignored)
└── .env.example              # Template
```

## Configuration

### Spreadsheet ID

Find your Google Sheets ID in the URL:
```
https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit
```

### Exclude Keywords

Jobs containing these keywords are skipped:
- NHS
- Council
- Government
- GP Practice
- Hospital

### Deduplication

Companies are skipped if contacted within the last 30 days.

## Logs

Logs are written to `output/outreach.log` and also printed to console.

## Troubleshooting

### Chrome driver issues

The webdriver-manager package automatically downloads the correct Chrome driver.
Make sure Google Chrome is installed.

### Google Sheets authentication

If you get auth errors:
1. Verify the service account JSON file is in `credentials/`
2. Check that the Google Sheet is shared with the service account email
3. Ensure the Sheets API is enabled in Google Cloud Console

### Rate limiting

If job boards block requests:
- Increase delays in `config.yaml`
- Reduce `max_results_per_run`
- Wait a few hours before trying again

## Support

For issues, contact Philip at philip@lochross.com
